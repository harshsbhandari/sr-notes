# Transaction Fees and Gas Prices in Ethereum

## Key Concepts

### Transaction Fee and Gas Price: What Are They?
Blockchains are maintained by nodes (miners or validators), which are incentivized through transaction fees. 
These fees are paid in the blockchain's native token (e.g., Ether for Ethereum, MATIC for Polygon). 
This incentive structure ensures that nodes continue processing transactions.

### Understanding Gas in Transactions
- **Gas**: A unit representing computational complexity required for the transaction.
    - Simple transactions (e.g., sending Ether) require less gas.
    - Complex transactions (e.g., minting NFTs, deploying smart contracts) require more gas.
  
- **Gas Price**: The cost per unit of gas, typically specified in GWei.
    - Higher gas prices increase the likelihood of your transaction being included in a block.
   
- **Transaction Fee Formula**:
  ```
  Transaction Fee = Gas Price * Gas Used
  ```
  Gas price is typically specified in GWei (1 Ether = 1,000,000,000 GWei (1e9)).

- **Gas Limit**
    - Maximum amount of gas allowed for the transaction.
    - Configurable before sending a transaction (e.g., in MetaMask under `Market > Advanced > Edit Gas Limit`).

- **Base Gas Fee**
    - The base cost of a transaction, represented in Gwei.
    - **Important Points**:
        - **Burning**: As per EIP-1559, the base fee is burned (removed from circulation) to counteract inflation.
        - **Dynamic Adjustment**:
            - If a block is >50% full, the base fee increases for the next block.
            - If a block is <50% full, the base fee decreases.

- **Max Gas Fee**
    - Maximum cost per gas unit the transaction is configured to allow.
    - Configurable before sending a transaction.

- **Max Priority Fee**
    - Maximum tip offered to miners for transaction inclusion.
    - Incentivizes miners to prioritize the transaction.

- **Block Confirmations**
    - Number of blocks mined/validated that confirm the transaction.
    - Higher confirmations increase confidence in the transaction's validity.

### Who Gets the Transaction Fee?
The transaction fee is rewarded to the block producer (miner/validator) for processing the transaction. 
This fee incentivizes maintaining the blockchain network.
**All the transactions that occurred in a chain can be seen in a block explorer like [Etherscan](https://etherscan.io). (For Ethereum)**

### Gas Limit and Usage
When viewing a transaction overview, you may see:
- **Gas Limit**: Maximum gas allowed for the transaction.
- **Gas Used by Transaction**: Actual gas consumed.

### Units of Measure
- **Wei**: Smallest denomination of Ether.
    - **1 Gwei = 1,000,000,000 Wei (1e9)**
- **Ether**:
    - **1 Eth = 1,000,000,000 Gwei (1e9)**

## Evolution of Ethereum Transactions
### Type 0: Legacy Transactions
- Used a first-price auction bidding system with `gasPrice` and `gasLimit`.
- Resulted in unpredictable fees and delayed transactions under congestion.

### Type 2: EIP-1559 Transactions
- Introduced a fee market with a **base fee** (burned) and optional **priority fee (tip)**.
- Base fee adjusts dynamically based on block fullness to stabilize fees.
- Priority fee incentivizes validators to prioritize transactions.
- This model improves predictability and efficiency of gas fees.

--

# The Complete Lifecycle of an Ethereum Transaction

## Overview
A transaction is a signed instruction by an account owner to change the blockchain state, such as sending ETH or interacting with a contract.
The process from confirmation to becoming part of the blockchain involves multiple steps ensuring validity and finality.

## Step 1: Creating the Transaction
- Wallet assembles transaction object including:
  - Chain ID: Prevents replay attacks across chains.
  - Nonce: Sequential transaction counter per account.
  - Gas parameters: Max priority fee, max fee, and gas limit.
  - Transaction details: Recipient address, ETH value, optional data for contracts, and access lists to reduce gas.

## Step 2: Signing the Transaction
- Transaction data serialized and hashed to create a unique transaction hash.
- Private key signs this hash producing a digital signature proving ownership.

## Step 3: Broadcasting the Transaction
- Signed transaction sent via RPC endpoint to Ethereum node for processing.

## Step 4: Entering the Mempool
- Node validates signature and account balance.
- Valid transaction enters the mempool (pending transactions pool).
- Transaction is broadcast across the network to other nodes.

## Step 5: Being Selected for a Block
- Every ~12 seconds a validator is selected to produce the next block.
- Validator prioritizes transactions offering the highest priority fees.
- Transactions executed in order, state updated, block signed and broadcast.

## Step 6: Attestation and Finalization
- Other validators (committee) verify the block and broadcast attestations.
- Block included when ≥2/3 staked ETH confirms it (confirmation).
- Finalized when ≥2/3 all active validators attest (typically ~12.8 minutes after submission).
- Finalized blocks are irreversible.

## Transaction Statuses
- Pending: In mempool awaiting inclusion.
- Confirmed: Included in a block (~12 seconds).
- Finalized: Irreversible state (~12.8 minutes).
- Reverted/Failed: Execution failed but gas fees consumed.
- Dropped: Removed from mempool (often due to low fees).

# More about Blockchain Transactions

## What is a Transaction?

- A transaction records an activity on the blockchain.
- Foundry saves blockchain interactions in the `broadcast` folder.
- Interactions without a running blockchain are saved in the `dry-run` folder.
- Recordings are separated by `chainId`.

## Understanding `chainId`

- Unique identifier for each blockchain network.
- Ensures security and integrity by distinguishing blockchains.

## Exploring `run-latest.json`

- Contains details of the last deployment script run.
- Key fields include `transactionType`, `contractName`, `contractAddress`, and `transaction`.

### Sample Transaction Object

```json
{
  "transaction": {
    "from": "0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266",
    "to": null,
    "gas": "0x714e1",
    "value": "0x0",
    "input": "0x608060...c63430008130033",
    "nonce": "0x0",
    "chainId": "0x7a69",
    "accessList": null,
    "type": null
  }
}
```

## Transaction Fields Explained
1. from: Address signing the transaction.
2. to: Recipient address; null when deploying a new contract.
3. gas: Gas spent in hex; convert with cast --to-base <hex> dec.
4. value: Amount of ETH sent; 0x0 when deploying contracts without initial balance.
5. input: Contract deployment or call data.
6. nonce: Unique counter to prevent replay attacks; increments per transaction by the sender.
7. accessList: Optimizes gas costs by listing accessed addresses and storage keys.
8. type: Currently ignored.

Additional Signature Fields (Not Shown)
- Components v, r, and s are parts of the transaction signature ensuring authenticity.

--

# How to Not Have Your Private Key in the Command Line

## Problem Recap

- Deploying with private key in plain text (example):
```bash
forge script script/DeploySimpleStorage.s.sol --rpc-url http://127.0.0.1:8545 --broadcast --private-key 0xYOUR_PRIVATE_KEY
```

- Exposing private keys in command line is insecure (see [Lesson 13 on Private Key Safety]
(https://updraft.cyfrin.io/courses/foundry/foundry-simple-storage/private-key-safety)).

## Safer Development Approach Using `.env`

1. Create a `.env` file at project root.
2. Ensure `.env` is listed in `.gitignore` to prevent public exposure.
3. Add sensitive variables inside `.env`:
```env
   PRIVATE_KEY=0xYOUR_PRIVATE_KEY
   RPC_URL=http://127.0.0.1:8545
```
4. Load variables into shell environment:
```bash
source .env
```
5. Use variables in command line:
```bash
forge script script/DeploySimpleStorage.s.sol --rpc-url $RPC_URL --broadcast --private-key $PRIVATE_KEY
```
6. Benefits:
- Hides private key from plain sight on command line.
- Avoids repeatedly typing long RPC URLs.

## Important Disclaimer
- .env files store private key in plain text, which is not safe for production.
- Do not use real private keys in .env files for production.

## Production-Grade Solutions
Use Foundryâ€™s keystore option:
```bash
forge script --keystore <PATH>
```
- This uses an encrypted keystore file protected by a password.
- Private key is never stored or exposed as plain text.
- Alternatively, use the --interactive option.

